import psycopg2
import pandas as pd

def sql_to_dataframe(conn, query):
    
    #Import data from a PostgreSQL database using a SELECT query
    cursor = conn.cursor()   
    try:
        cursor.execute(query)
    except (Exception, psycopg2.DatabaseError) as error:
        print("Error: %s" % error)
        cursor.close()
        return 1
    
    # Return a list of tuples:   
    tuples_list = cursor.fetchall()   
    
    # Transform the list into a pandas DataFrame:   
    df = pd.DataFrame(tuples_list, columns=[col[0] for col in cursor.description])
    cursor.close()   
    return df



def  haddle_missing_values (df):

     missing_values = df.isnull.sum()

     print(missing_values)
 
     return missing_values
    




